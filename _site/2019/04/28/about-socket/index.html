<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>About socket | Raymond’s Blog</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="About socket" />
<meta name="author" content="raymondchen625" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Most if not all of my applications I have worked on were about HTTP, which is a stateless protocol. Until lately we started to work on a feature with websocket." />
<meta property="og:description" content="Most if not all of my applications I have worked on were about HTTP, which is a stateless protocol. Until lately we started to work on a feature with websocket." />
<link rel="canonical" href="/2019/04/28/about-socket/" />
<meta property="og:url" content="/2019/04/28/about-socket/" />
<meta property="og:site_name" content="Raymond’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-28T06:19:42-04:00" />
<script type="application/ld+json">
{"description":"Most if not all of my applications I have worked on were about HTTP, which is a stateless protocol. Until lately we started to work on a feature with websocket.","author":{"@type":"Person","name":"raymondchen625"},"@type":"BlogPosting","url":"/2019/04/28/about-socket/","headline":"About socket","dateModified":"2019-04-28T06:19:42-04:00","datePublished":"2019-04-28T06:19:42-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/04/28/about-socket/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Raymond's Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Raymond&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">About socket</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-04-28T06:19:42-04:00" itemprop="datePublished">Apr 28, 2019
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">raymondchen625</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Most if not all of my applications I have worked on were about HTTP, which is a stateless protocol. Until lately we started to work on a feature with websocket.</p>

<p>I ran some tests to help me understand how the connection is opened and closed. I deploy several websocket services in containers. I use a wscat tool to access them.</p>

<p>Some observations:</p>

<ol>
  <li>The connection will keep open even I don’t send any data in hours. That depends on the implementation of the nodes between them. Say if we have routers between them, some routers might decide to drop the session in 1 idle hour. That’s why we usually need keepalive to keep it going.</li>
  <li>When I kill the client process or the server process, the connection will be closed shortly. That’s due to the mechanism when a Linux process receives a terminate signal (KILL), it tries to close the file descriptors and TCP connections as cleanup.</li>
  <li>If I terminate some service between them, like the ‘flanneld’ in my Kubernetes service, which also brings down the docker service, the connection is in fact closed. But the client won’t notice it until it tries to send data again. That’s due to when I do that, it’s like powering off some routers, the Linux process termination mechanism has no chance to kick in.</li>
</ol>

<p>Conclusions:</p>

<ol>
  <li>Sockets try their best to clean up on many occasions. But keep alive is still needed</li>
  <li>The network nodes between the two parties have impacts on the behaviors. Some might keep a shorter session. Some might not be able to clean up when they go out of service.</li>
</ol>

  </div><a class="u-url" href="/2019/04/28/about-socket/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Raymond&#39;s Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Raymond&#39;s Blog</li><li><a class="u-email" href="mailto:raymond@raymondchen.com">raymond@raymondchen.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/raymondchen625"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">raymondchen625</span></a></li><li><a href="https://www.twitter.com/raymondchen625"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">raymondchen625</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
