---
id: 22
title: 关于是否删除数据
date: 2010-04-01T08:01:58+00:00
author: raymondchen625
layout: post
guid: http://www.raymondchen.info/?p=22
permalink: '/2010/04/01/%e5%85%b3%e4%ba%8e%e6%98%af%e5%90%a6%e5%88%a0%e9%99%a4%e6%95%b0%e6%8d%ae/'
original_post_id:
  - "22"
  - "1083"
categories:
  - 技术
tags:
  - NoSQL
---
转述一段关于是否删除数据的讨论。<a href="http://yankay-static.googlecode.com/svn/trunk/NoSql%20Database%20Note/index.html#_3648342117667198_092538481578" target="_blank" rel="noopener noreferrer">出处</a>

&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;分割线&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;

假设市场部决定从 商品目录中删除一样商品，那是不是说所有包含了该商品的旧订单都要一并消失？再级联下去，这些订单对应的所有发票是不是也该删除？这么一步步删下去，我们 公司的损益报表是不是应该重做了？

没天理了。

问题似乎出在对“删除”这词的解读上。Dahan给出了这样的例子：

我说的“删除”其实是指这产品“停售”了。我们以后不再卖这种产品，清掉库存以后不再进货。以后顾客搜索商品或者翻阅目录的时候不会再看见这种商品，但管 仓库的人暂时还得继续管理它们。“删除”是个贪方便的说法。

他接着举了一些站在用户角度的正确解读：

订单不是被删除的，是被“取消”的。订单取消得太晚，还会产生花费。

员工不是被删除的，是被“解雇”的（也可能是退休了）。还有相应的补偿金要处理。

职位不是被删除的，是被“填补”的（或者招聘申请被撤回）。

在上面这些例子中，我们的着眼点应该放在用户希望完成的任务上，而非发生在某个  
实体身上的技术动作。几乎在所有的情况下，需要考虑的实体总不止一个。

为了代替IsDeleted标志，Dahan建议用一个代表相关数据状态的字段：有效、停用、取消、弃置等等。用户可以借助这样一个状态字段回顾过去的数 据，作为决策的依据。

删除数据除了破坏数据一致性，还有其它负面的后果。Dahan建议把所有数据都留在数据库里：“别删除。就是别  
删除。”